<div class="container">
  <div class="checkbox">
    <label>
      <input type="checkbox" [(ngModel)]="lock"/> Unlock Patient Record
    </label>
  </div>
  <form [formGroup]="patientForm" (ngSubmit)="submitRegistration()" validate>
    <fieldset [disabled]="lock">
      <div *ngIf="validMessage != ''">
        <h3 class="has-info">{{validMessage}}</h3>
      </div>
      <div class="form-group">
        <input type="hidden" formControlName="id"  />
      </div>
      <div class="form-group">
        <label>Patient First Name</label>
        <input type="text" class="form-control" formControlName="firstName" autofocus/>
      </div>
      <div class="form-group">
        <label>Middle Name</label>
        <input type="text" class="form-control" formControlName="middleName"/>
      </div>
      <div class="form-group">
        <label>Last Name</label>
        <input type="text" class="form-control" formControlName="lastName"/>
      </div>
      <div class="form-group">
        <label>Patient SSN</label>
        <input type="text" class="form-control" formControlName="ssn"/>
      </div>
      <div formArrayName="addresses">
          <div *ngFor="let control of patientForm.controls['addresses'].controls; let i = index">
              <button type="button" (click)="delAddress(i)">Delete</button>
              <address-sub-component [addressForm]="patientForm.controls.addresses.controls[i]"></address-sub-component>
          </div>
      </div>
      <button type="button" (click)="addAddress()">Add Address</button>
      <div formArrayName="emailAddresses">
          <div *ngFor="let control of patientForm.controls['emailAddresses'].controls; let i = index">
              <button type="button" (click)="delEmail(i)">Delete</button>
              <email-sub-component [emailForm]="patientForm.controls.emailAddresses.controls[i]"></email-sub-component>
          </div>
      </div>
      <button type="button" (click)="addEmail()">Add Email</button>
      <div formArrayName="phoneNumbers">
          <div *ngFor="let control of patientForm.controls['phoneNumbers'].controls; let i = index">
              <button type="button" (click)="delPhone(i)">Delete</button>
              <phone-sub-component [phoneForm]="patientForm.controls.phoneNumbers.controls[i]"></phone-sub-component>
          </div>
      </div>
      <button type="button" (click)="addPhone()">Add Phone Number</button>

      <button type="submit" [disabled]="!patientForm.valid" class="btn btn-primary" >Submit</button>


      <div *ngIf="patient && patient.appointments.length">
        Appointments
        <table class="table table-bordered table-inverse">
          <tr>
            <th>Id</th>
          </tr>
          <tr *ngFor="let appointment of patient.appointments">
            <td>
              {{appointment}}
            </td>
          </tr>
        </table>
      </div>

      <div *ngIf="patient && patient.labRecords.length">
        Lab Records
        <table class="table table-bordered table-inverse">
          <tr>
            <th>Id</th>
          </tr>
          <tr *ngFor="let record of patient.labRecords">
            <td>
              {{record}}
            </td>
          </tr>
        </table>
      </div>
    </fieldset>
  </form>
</div>
